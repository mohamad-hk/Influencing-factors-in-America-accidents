# پیش‌ بینی شدت تصادف با XGBoost

## معرفی پروژه

در این پروژه از دیتاست [US Accidents](https://www.kaggle.com/datasets/sobhanmoosavi/us-accidents) استفاده شده است. هدف اصلی، پیش‌بینی شدت تصادف و بررسی عواملی است که بیشترین تأثیر را بر شدت تصادف دارند. برای این منظوراز **XGBoost** استفاده شده است 

---

## پیش‌ نیازها
 
برای اجرای این پروژه نیاز به نصب پکیج‌ های زیر داریم:

```
pandas
cudf
numpy
matplotlib
seaborn
scikit-learn
xgboost
```

## مراحل انجام پروژه

# 1. خواندن داده‌ها
دیتاست اصلی بیش از 7 میلیون رکورد دارد. ابتدا داده‌ها را بارگذاری و سپس مراحل پیش پردازش را انجام می دهیم.

# 2. پیش‌ پردازش داده ‌ها

با توجه به این که حجم داده زیاد است، باید عملیات پیش پردازش بر روری داده ها که شامل چندین مرحله است را بر روی داده ها اعمال کنیم. در ادامه هر مرحله با جزیئات توضیح داده می شود.

## 2.1 حذف ستون های غیر ضروری
برای پیش‌ پردازش داده‌ ها، ستون‌ های غیر ضروری مانند ID، Description، Country، Source و Timezone حذف شدند، مقادیر گمشده با میانه یا صفر جایگزین شدند، داده‌ه ای متنی با استفاده از LabelEncoder به مقادیر عددی تبدیل شدند و در نهایت برای کاهش حجم داده، انواع داده‌ ها با کمک تابع auto_data_type به کوچک‌ ترین نوع ممکن تغییر یافتند.


## 2.2 پر کردن مقادیر خالی داده‌ها
در بعضی رکورد های داده یک سری ستون فیلد های خالی وجود داشت که بر اساس مقادیر آن ستون می تواند داشته باشد، آن مقادیر خالی را با بهترین مقادیر پر کردیم تا تحلیل مان درست باشد.در بعضی ستون ها مانند Wind_Speed,Pressure,Visibility,Humidity مقادیر را با میانه هر ستون پر کردیم. در ستون های End_Lat,End_Lng مقادیر شان را با به ترتیب با Start_Lat,Start_Lng پر کردیم زیرا این عمل باعث می شود توزیع داده هامون حفظ شود و تاثیر منفی ای بر روی تحلیل مان نگذارد.

## 2.3 تقسیم داده‌ها
بعضی ستون ها مانند City, State, Weather_Condition,Street, Wind_Direction, Sunrise_Sunset, Civil_Twilight, Nautical_Twilight, Astronomical_Twilight,County که مقادیر گسسته ای داشتند آن ها  را با LabelEncoder تبدیل به یک سری اعداد کردیم که حجم داده مان کاهش یابد


## 2.4 تبدیل داده های رشته ای
ستون ‌های (`Start_Time`, `End_Time`, `Weather_Timestamp`) به ویژگی‌ های عددی شامل سال، ماه، روز، ساعت و روز هفته تبدیل شدند، چون XGBoost با داده هایی که نوع آنها object است نمی تواند آموزش ببیند و ستون `Zipcode` نیز به صورت عددی پردازش شد .



# 3. تقسیم داده‌ها
داده‌ها به مجموعه‌های `train` و `test`  با نسبت 80 درصد برای آموزش و 20 درصد برای تست تقسیم شدند.


# 4. آموزش مدل

# 5. ارزیابی نتایج


